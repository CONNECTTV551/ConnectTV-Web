<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ConnectTV | Tu Acceso Premium al Entretenimiento Digital</title>
    <link rel="stylesheet" href="style.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <!-- Firebase SDKs -->
    <script type="module">
        // Importa los módulos necesarios de Firebase SDKs.
        // Estos módulos son cruciales para la inicialización de la aplicación,
        // la autenticación de usuarios y la interacción con la base de datos Firestore.
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, onAuthStateChanged, createUserWithEmailAndPassword, signInWithEmailAndPassword, signOut as firebaseSignOut, sendPasswordResetEmail, confirmPasswordReset, updatePassword } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js"; // Añadido updatePassword
        import { getFirestore, collection, addDoc, onSnapshot, query, doc, getDoc, setDoc, updateDoc, where, getDocs, deleteDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Variables globales para la configuración de Firebase y el ID de la aplicación.
        const firebaseConfig = JSON.parse(typeof __firebase_config !== 'undefined' ? __firebase_config : '{}');
        
        if (Object.keys(firebaseConfig).length === 0) {
            Object.assign(firebaseConfig, {
                apiKey: "AIzaSyBPAASk4M0gCUv3kxRDrRPztLuEdU8lP80",
                authDomain: "miplataformaconnecttv.firebaseapp.com",
                projectId: "miplataformaconnecttv",
                storageBucket: "miplataformaconnecttv.firebasestorage.app",
                messagingSenderId: "10232906249",
                appId: "1:10232906249:web:34141fc9c383e4fb06aed8",
                measurementId: "G-V3YG3TVT1Y"
            });
        }

        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);

        // Expone los objetos y funciones de Firebase globalmente.
        window.firebaseApp = app;
        window.firebaseDb = db;
        window.firebaseAuth = auth;
        window.__app_id = appId;
        window.addDoc = addDoc;
        window.collection = collection;
        window.onSnapshot = onSnapshot;
        window.query = query;
        window.doc = doc;
        window.getDoc = getDoc;
        window.setDoc = setDoc;
        window.updateDoc = updateDoc;
        window.where = where;
        window.getDocs = getDocs;
        window.deleteDoc = deleteDoc;
        window.createUserWithEmailAndPassword = createUserWithEmailAndPassword;
        window.signInWithEmailAndPassword = signInWithEmailAndPassword;
        window.signOut = () => firebaseSignOut(auth);
        window.onAuthStateChanged = onAuthStateChanged;
        window.sendPasswordResetEmail = sendPasswordResetEmail;
        window.confirmPasswordReset = confirmPasswordReset;
        window.updatePassword = updatePassword; // Expone updatePassword

        // Variable global para almacenar la función de desuscripción del listener de clientes
        window.unsubscribeClientsListener = null;

        // Función para configurar un listener en tiempo real para los datos de clientes desde Firestore.
        window.setupClientsRealtimeListener = function() {
            // Si ya hay un listener activo, desuscribirse de él primero para evitar duplicados
            if (window.unsubscribeClientsListener) {
                window.unsubscribeClientsListener();
                console.log("Firestore: Listener de clientes desuscrito (evitando duplicados).");
                window.unsubscribeClientsListener = null;
            }

            // Solo configurar el listener si Firebase está completamente listo y el rol es admin
            // La comprobación de rol se hará en handleAuthSuccess antes de llamar a esta función
            if (window.firebaseDb && window.collection && window.onSnapshot && window.__app_id) {
                console.log("Firestore: Configurando listener de clientes...");
                const clientsCollectionRef = collection(db, `artifacts/${appId}/public/data/registered_clients`);
                const q = query(clientsCollectionRef); // Sin orderBy aquí, se ordena en JS si es necesario

                window.unsubscribeClientsListener = onSnapshot(q, (snapshot) => {
                    const clientsFromDb = [];
                    snapshot.forEach((doc) => {
                        clientsFromDb.push({ id: doc.id, ...doc.data() });
                    });
                    // Ordenar clientes por fecha de registro en JS (más nuevos primero)
                    clientsFromDb.sort((a, b) => {
                        const dateA = a.registrationDate && typeof a.registrationDate.toDate === 'function' ? a.registrationDate.toDate() : new Date(0);
                        const dateB = b.registrationDate && typeof b.registrationDate.toDate === 'function' ? b.registrationDate.toDate() : new Date(0);
                        return dateB - dateA;
                    });
                    
                    if (window.renderClients) {
                        window.renderClients(clientsFromDb); 
                        console.log("Firestore: Clientes renderizados en la tabla.");
                    } else {
                        console.warn("Firestore: La función renderClients aún no está disponible.");
                    }
                }, (error) => {
                    // Manejo de errores en caso de que la lectura de datos falle.
                    console.error("Firestore: Error al obtener los datos del cliente:", error);
                });
            } else {
                console.log("Firestore: Firebase no está completamente listo para configurar el listener de clientes.");
            }
        };

        // Lógica de autenticación inicial al cargar la página
        onAuthStateChanged(auth, async (user) => {
            console.log("Auth: onAuthStateChanged disparado.");
            if (user) {
                console.log("Auth: Usuario autenticado:", user.uid);
                const userDocRef = doc(db, `artifacts/${appId}/users`, user.uid);
                const userDocSnap = await getDoc(userDocRef);

                let role = 'client';
                if (userDocSnap.exists()) {
                    role = userDocSnap.data().role;
                    console.log("Auth: Rol del usuario desde Firestore:", role);
                } else {
                    await setDoc(userDocRef, { role: 'client', email: user.email }, { merge: true });
                    console.log("Auth: Documento de usuario creado con rol 'client'.");
                }
                window.currentUserRole = role;

                if (window.handleAuthSuccess) {
                    window.handleAuthSuccess(role, user.uid); // Pasamos el UID para que script.js lo use
                } else {
                    console.warn("Auth: window.handleAuthSuccess aún no está disponible en script.js.");
                    setTimeout(() => {
                        if (window.handleAuthSuccess) {
                            window.handleAuthSuccess(role, user.uid);
                        }
                    }, 200);
                }
            } else {
                console.log("Auth: Usuario no autenticado (o sesión cerrada).");
                window.currentUserRole = null;
                if (window.showSection) {
                    window.showSection('auth-section');
                } else {
                    console.warn("Auth: window.showSection aún no está disponible. Reintentando...");
                    setTimeout(() => {
                        if (window.showSection) {
                            window.showSection('auth-section');
                        }
                    }, 200);
                }
                if (window.unsubscribeClientsListener) {
                    window.unsubscribeClientsListener();
                    window.unsubscribeClientsListener = null;
                    console.log("Firestore: Listener de clientes desuscrito (usuario no autenticado).");
                }
            }
        });
    </script>
</head>
<body>
    <!-- Loading Spinner -->
    <div id="loading-spinner" class="loading-spinner">
        <div class="spinner"></div>
    </div>

    <!-- Toast Notifications Container -->
    <div id="toast-container" class="toast-container"></div>

    <!-- HEADER: Inicialmente oculto hasta que el usuario inicie sesión -->
    <header class="header hidden-on-auth">
        <div class="container">
            <div class="logo">
                <a href="#"><img src="img/connecttv-logo.png" alt="ConnectTV Logo"></a>
            </div>
            <nav class="nav">
                <ul>
                    <li><a href="#" class="active" data-section="home">Inicio</a></li>
                    <li><a href="#" data-section="full-accounts">Cuentas Completas</a></li>
                    <li><a href="#" data-section="shared-profiles">Perfiles</a></li>
                    <!-- Enlace del panel de clientes, inicialmente oculto para usuarios no administradores -->
                    <li><a href="#" data-section="clients-panel" id="clients-panel-nav-link" class="hidden-on-auth">Clientes</a></li> 
                    <!-- Botón para cerrar sesión -->
                    <li><a href="#" id="logout-link">Cerrar Sesión</a></li>
                </ul>
            </nav>
            <div class="header-actions">
                <div class="search-box">
                    <input type="text" placeholder="Buscar servicios...">
                    <i class="fas fa-search"></i>
                </div>
            </div>
        </div>
    </header>

    <main>
        <!-- SECCIÓN DE AUTENTICACIÓN: Activa por defecto al cargar la página -->
        <section class="auth-section active-section" id="auth-section">
            <!-- El fondo animado se aplica directamente a .auth-section via CSS -->

            <!-- Nuevo: Contenedor para el mensaje de bienvenida y el logo -->
            <div class="auth-welcome-header">
                <!-- RUTA DEL LOGO REAL: Asegúrate de que este archivo exista en tu carpeta 'img/' -->
                <img src="img/connecttv-logo-small.png" alt="ConnectTV Logo" class="auth-logo">
                <h1>Bienvenido a ConnectTV</h1>
                <p>Tu portal al entretenimiento premium.</p>
            </div>

            <!-- CONTENEDOR DE AUTENTICACIÓN: Contiene los formularios de inicio de sesión/registro -->
            <div class="auth-container">
                <!-- Los formularios de inicio de sesión/registro se mostrarán aquí dinámicamente -->
                <div id="login-form-container">
                    <h2>Iniciar Sesión</h2>
                    <form id="login-form">
                        <div class="input-group input-float-group">
                            <input type="email" id="login-email" required placeholder=" ">
                            <label for="login-email">Correo Electrónico</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="password" id="login-password" required placeholder=" ">
                            <label for="login-password">Contraseña</label>
                        </div>
                        <button type="submit" class="btn primary-btn">Ingresar</button>
                        <p id="login-message" class="message" style="display: none;"></p>
                    </form>
                    <div class="auth-switch-links">
                        <p>¿No tienes cuenta? <a href="#" id="show-register">Regístrate aquí</a></p>
                        <p><a href="#" id="show-forgot-password">Olvidé mi contraseña</a></p>
                    </div>
                </div>

                <div id="register-form-container" style="display: none;">
                    <h2>Crear Cuenta</h2>
                    <form id="register-form">
                        <div class="input-group input-float-group">
                            <input type="text" id="register-name" required placeholder=" ">
                            <label for="register-name">Nombre</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="text" id="register-lastname" required placeholder=" ">
                            <label for="register-lastname">Apellido</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="email" id="register-email" required placeholder=" ">
                            <label for="register-email">Correo Electrónico</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="password" id="register-password" required placeholder=" ">
                            <label for="register-password">Contraseña</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="password" id="confirm-password" required placeholder=" ">
                            <label for="confirm-password">Confirmar Contraseña</label>
                        </div>
                        <div class="input-group whatsapp-input-group">
                            <!-- El label para WhatsApp se mantiene fuera del input-float-group para el select -->
                            <label for="register-whatsapp-code">WhatsApp:</label>
                            <div class="whatsapp-flex-container">
                                <select id="register-whatsapp-code" class="whatsapp-code-select">
                                    <option value="+58" selected>+58 (Venezuela)</option>
                                    <option value="+1">+1 (USA/Canadá)</option>
                                    <option value="+57">+57 (Colombia)</option>
                                    <option value="+51">+51 (Perú)</option>
                                    <option value="+54">+54 (Argentina)</option>
                                    <option value="+56">+56 (Chile)</option>
                                    <option value="+52">+52 (México)</option>
                                    <option value="+34">+34 (España)</option>
                                    <option value="+593">+593 (Ecuador)</option>
                                    <option value="+507">+507 (Panamá)</option>
                                    <option value="+504">+504 (Honduras)</option>
                                    <option value="+505">+505 (Nicaragua)</option>
                                    <option value="+506">+506 (Costa Rica)</option>
                                    <option value="+503">+503 (El Salvador)</option>
                                    <option value="+591">+591 (Bolivia)</option>
                                    <option value="+595">+595 (Paraguay)</option>
                                    <option value="+598">+598 (Uruguay)</option>
                                    <option value="+53">+53 (Cuba)</option>
                                    <option value="+502">+502 (Guatemala)</option>
                                    <option value="+592">+592 (Guyana)</option>
                                    <option value="+597">+597 (Surinam)</option>
                                    <option value="+599">+599 (Curazao)</option>
                                    <option value="+809">+809 (Rep. Dominicana)</option>
                                    <option value="+829">+829 (Rep. Dominicana)</option>
                                    <option value="+849">+849 (Rep. Dominicana)</option>
                                    <!-- Puedes añadir más códigos de país aquí -->
                                </select>
                                <input type="text" id="register-whatsapp-number" required placeholder="Número de WhatsApp">
                            </div>
                        </div>
                        <button type="submit" class="btn primary-btn" id="register-submit-btn">Registrarse</button>
                        <p id="register-message" class="message" style="display: none;"></p>
                    </form>
                    <p class="auth-switch">¿Ya tienes cuenta? <a href="#" id="show-login">Inicia Sesión</a></p>
                </div>

                <!-- NUEVO: Formulario para restablecer contraseña con código -->
                <div id="forgot-password-code-form-container" style="display: none;">
                    <h2>Restablecer Contraseña</h2>
                    <p class="instruction-message">
                        Se ha enviado un enlace de restablecimiento a tu correo. Por favor, ábrelo y copia el código (oobCode) de la URL para pegarlo aquí.
                    </p>
                    <form id="forgot-password-code-form">
                        <div class="input-group input-float-group">
                            <input type="email" id="forgot-email-display" readonly placeholder=" ">
                            <label for="forgot-email-display">Correo Electrónico</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="text" id="oob-code" required placeholder=" ">
                            <label for="oob-code">Código de Verificación</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="password" id="new-password-reset" required placeholder=" ">
                            <label for="new-password-reset">Nueva Contraseña</label>
                        </div>
                        <div class="input-group input-float-group">
                            <input type="password" id="confirm-new-password-reset" required placeholder=" ">
                            <label for="confirm-new-password-reset">Confirmar Nueva Contraseña</label>
                        </div>
                        <button type="submit" class="btn primary-btn">Restablecer Contraseña</button>
                        <p id="forgot-password-code-message" class="message" style="display: none;"></p>
                    </form>
                    <p class="auth-switch">¿Recordaste tu contraseña? <a href="#" id="show-login-from-forgot-code">Inicia Sesión</a></p>
                </div>
            </div>
        </section>

        <!-- SECCIONES PRINCIPALES (Inicialmente ocultas) -->
        <section class="hero-section hero-market hidden-section" id="home-section">
            <div class="hero-content container">
                <h1>Tu Acceso a Todo el Entretenimiento Premium</h1>
                <p>Consigue cuentas y perfiles de Netflix, Disney+, Spotify y muchos más al mejor precio. ¡Acceso instantáneo y garantizado!</p>
                <div class="hero-buttons">
                    <button type="button" class="btn primary-btn help-support-btn" data-type="ayuda"><i class="fas fa-question-circle"></i> Ayuda</button>
                    <button type="button" class="btn secondary-btn help-support-btn" data-type="soporte"><i class="fas fa-headset"></i> Soporte</button>
                    <!-- Nuevo botón para explorar servicios -->
                    <button type="button" class="btn primary-btn explore-services-btn">Explorar Servicios</button>
                </div>
            </div>
            <div class="carousel-container">
                <div class="mySlides fade">
                    <img src="img/estreno1.jpg" alt="Estreno de Película 1">
                </div>
                <div class="mySlides fade">
                    <img src="img/estreno2.jpg" alt="Estreno de Película 2">
                </div>
                <div class="mySlides fade">
                    <img src="img/estreno3.jpg" alt="Estreno de Película 3">
                </div>
                <div class="mySlides fade">
                    <img src="img/estreno4.jpg" alt="Estreno de Película 4">
                </div>
                <div class="mySlides fade">
                    <img src="img/estreno5.jpg" alt="Estreno de Película 5">
                </div>
                <a class="prev" onclick="plusSlides(-1)"><i class="fas fa-chevron-left"></i></a>
                <a class="next" onclick="plusSlides(1)"><i class="fas fa-chevron-right"></i></a>
            </div>
            <div class="dot-navigation">
                <span class="dot" onclick="currentSlide(1)"></span>
                <span class="dot" onclick="currentSlide(2)"></span>
                <span class="dot" onclick="currentSlide(3)"></span>
                <span class="dot" onclick="currentSlide(4)"></span>
                <span class="dot" onclick="currentSlide(5)"></span>
            </div>
        </section>

        <section class="content-rows hidden-section" id="full-accounts-section">
            <div class="container">
                <h2>Cuentas Completas Disponibles</h2>
                <div class="carousel" id="full-accounts-carousel">
                    <!-- Las tarjetas de servicio se cargarán aquí con JavaScript -->
                </div>
            </div>
        </section>

        <section class="content-rows hidden-section" id="shared-profiles-section">
            <div class="container">
                <h2>Perfiles Compartidos al Instante</h2>
                <div class="carousel" id="shared-profiles-carousel">
                    <!-- Las tarjetas de perfil se cargarán aquí con JavaScript -->
                </div>
            </div>
        </section>

        <section class="clients-panel hidden-section" id="clients-panel-section">
            <div class="container">
                <h2>Panel de Clientes</h2>
                <div class="client-table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Correo</th>
                                <th>Nombre y Apellido</th> <!-- Encabezado combinado -->
                                <th>WhatsApp</th>
                                <th>Contraseña</th>
                                <th>Activación</th>
                                <!-- <th>Corte</th> Eliminado -->
                                <th>Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="client-data-body">
                            <!-- Los datos de los clientes se cargarán aquí con JavaScript desde Firestore -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

    </main>

    <!-- FOOTER: Inicialmente oculto hasta que el usuario inicie sesión -->
    <footer class="footer hidden-on-auth">
        <div class="container">
            <div class="footer-links">
                <a href="#">Preguntas Frecuentes</a>
                <a href="#">Centro de Ayuda</a>
                <a href="#">Términos y Condiciones</a>
                <a href="#">Política de Privacidad</a>
            </div>
            <p>&copy; 2025 ConnectTV. Todos los derechos reservados.</p>
        </div>
    </footer>

    <!-- PANEL DE WHATSAPP FLOTANTE -->
    <div id="whatsapp-panel" class="whatsapp-panel hidden-on-auth">
        <button type="button" class="whatsapp-toggle-btn" title="Soporte WhatsApp"><i class="fab fa-whatsapp"></i></button>
    </div>

    <!-- Modales (no ocultos inicialmente ya que son modales) -->
    <div id="renewal-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Renovar Cuenta</h3>
            <form id="renewal-form">
                <div class="input-group input-float-group">
                    <input type="text" id="client-name" required placeholder=" ">
                    <label for="client-name">Nombre del Cliente</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="text" id="whatsapp" required placeholder=" ">
                    <label for="whatsapp">WhatsApp</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="text" id="renewal-text" required placeholder=" ">
                    <label for="renewal-text">Escribe "renovar" para confirmar</label>
                </div>
                <button type="submit" class="btn primary-btn">Renovar</button>
            </form>
            <p id="renewal-message" class="success-message" style="display: none;"></p>
        </div>
    </div>

    <div id="report-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Reportar Falla</h3>
            <form id="report-form">
                <div class="input-group input-float-group">
                    <input type="email" id="reported-email" readonly placeholder=" ">
                    <label for="reported-email">Correo de la cuenta</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="password" id="reported-password" placeholder=" ">
                    <label for="reported-password">Contraseña (opcional)</label>
                </div>
                <div class="input-group">
                    <label for="reported-country">País:</label>
                    <select id="reported-country" required>
                        <option value="">Selecciona un país</option>
                        <!-- Las opciones de país se cargarán con JS -->
                    </select>
                </div>
                <div class="input-group input-float-group">
                    <textarea id="issue-description" rows="4" required placeholder=" "></textarea>
                    <label for="issue-description">Descripción de la falla</label>
                </div>
                <button type="submit" class="btn primary-btn">Enviar Reporte</button>
            </form>
            <p id="report-message" class="success-message" style="display: none;"></p>
        </div>
    </div>

    <div id="buy-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Comprar Servicio</h3>
            <p>Servicio: <strong id="modal-service-name"></strong> (<span id="modal-service-type"></span>)</p>
            <p>Monto a pagar: <strong id="payment-amount-ves"></strong></p> 
            
            <div class="payment-methods-container">
                <h4>Selecciona tu método de pago:</h4>
                <div class="accordion">
                    <!-- Pago Móvil Venezuela -->
                    <div class="accordion-item">
                        <button type="button" class="accordion-header">
                            <i class="fas fa-money-bill-transfer"></i> Pago Móvil Banco de Venezuela
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </button>
                        <div class="accordion-content">
                            <p>Banco: Banco de Venezuela</p>
                            <p>Teléfono: 0412-3790923</p>
                            <p>Cédula/RIF: 28308736</p>
                            <p>Titular: GILBERTO GOTERA</p>
                        </div>
                    </div>
                    <!-- Pago Móvil Bancamiga -->
                    <div class="accordion-item">
                        <button type="button" class="accordion-header">
                            <i class="fas fa-mobile-screen-button"></i> Pago Móvil Bancamiga
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </button>
                        <div class="accordion-content">
                            <p>Banco: Bancamiga</p>
                            <p>Teléfono: 0412-3790923</p>
                            <p>Cédula/RIF: 28308736</p>
                            <p>Titular: GILBERTO GOTERA</p>
                        </div>
                    </div>
                    <!-- Binance -->
                    <div class="accordion-item">
                        <button type="button" class="accordion-header">
                            <i class="fas fa-coins"></i> Binance (P2P)
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </button>
                        <div class="accordion-content">
                            <p>Usuario/Correo: **gilbertogotera1998@gmail.com**</p>
                            <p>Método: USDT (puedes especificar P2P, ID, etc. según prefieras)</p>
                        </div>
                    </div>
                    <!-- PayPal -->
                    <div class="accordion-item">
                        <button type="button" class="accordion-header">
                            <i class="fab fa-paypal"></i> PayPal
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </button>
                        <div class="accordion-content">
                            <p>Correo: **gilbertogotera1998@gmail.com**</p>
                            <p class="paypal-note">**¡Importante! Recuerda cubrir la comisión de PayPal al enviar el pago.**</p>
                        </div>
                    </div>
                    <!-- Zinli -->
                    <div class="accordion-item">
                        <button type="button" class="accordion-header">
                            <i class="fas fa-wallet"></i> Zinli
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </button>
                        <div class="accordion-content">
                            <p>Correo: **gilbertogotera1998@gmail.com**</p>
                        </div>
                    </div>
                    <!-- AirTM -->
                    <div class="accordion-item">
                        <button type="button" class="accordion-header">
                            <i class="fas fa-cloud-arrow-up"></i> AirTM
                            <i class="fas fa-chevron-right arrow-icon"></i>
                        </button>
                        <div class="accordion-content">
                            <p>Correo: **gilbertogotera1998@gmail.com**</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Campos para comprobante de pago -->
            <form id="payment-proof-form">
                <div class="input-group input-float-group">
                    <input type="text" id="customer-name" required placeholder=" ">
                    <label for="customer-name">Tu Nombre Completo</label>
                </div>
                <label for="payment-proof">Subir Comprobante de Pago:</label>
                <input type="file" id="payment-proof" accept="image/*" required>
                <div class="image-preview" id="image-preview">
                    <span class="preview-text">Vista previa del comprobante</span>
                    <img src="" alt="Previsualización del Comprobante" style="display: none;" class="preview-image">
                </div>

                <div class="input-group input-float-group">
                    <input type="date" id="payment-date" required placeholder=" ">
                    <label for="payment-date">Fecha del Pago</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="time" id="payment-time" required placeholder=" ">
                    <label for="payment-time">Hora del Pago</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="text" id="transaction-id" placeholder=" " required>
                    <label for="transaction-id">ID de la Transacción</label>
                </div>
                <button type="submit" class="btn primary-btn">Enviar Comprobante y Contactar</button>
            </form>
            <p id="payment-message" class="success-message" style="display: none;"></p>
        </div>
    </div>

    <div id="details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3 id="details-service-name"></h3>
            <div class="details-info">
                <p><i class="fas fa-calendar-alt"></i> Duración: <strong id="details-duration"></strong></p>
                <p><i class="fas fa-users"></i> Tipo de Cuenta: <strong id="details-account-type"></strong></p>
                <p><i class="fas fa-sync-alt"></i> Renovable: <strong id="details-renewable"></strong></p>
                <p class="details-note">
                    <i class="fas fa-info-circle"></i> Esta información es general. Para detalles específicos de tu compra, consulta los términos y condiciones.
                </p>
            </div>
            <button type="button" class="btn primary-btn close-button">Cerrar</button>
        </div>
    </div>

    <!-- Modal de Restablecimiento de Contraseña para Admin -->
    <div id="reset-password-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Restablecer Contraseña del Cliente</h3>
            <p class="instruction-message">
                Establece una contraseña temporal para el cliente.
                <br>
                <strong style="color: var(--error-color);">¡IMPORTANT!</strong> Después de establecerla aquí,
                <strong style="color: var(--error-color);">DEBES CAMBIAR MANUALMENTE LA CONTRASEÑA DE ESTE USUARIO EN LA CONSOLA DE FIREBASE AUTHENTICATION</strong>
                a esta misma contraseña temporal para que el cliente pueda iniciar sesión con ella.
            </p>
            <form id="reset-password-form">
                <div class="input-group input-float-group">
                    <input type="email" id="reset-client-email" readonly placeholder=" ">
                    <label for="reset-client-email">Correo del Cliente</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="password" id="new-password" required placeholder=" ">
                    <label for="new-password">Nueva Contraseña Temporal</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="password" id="confirm-new-password" required placeholder=" ">
                    <label for="confirm-new-password">Confirmar Contraseña Temporal</label>
                </div>
                <button type="submit" class="btn primary-btn">Establecer Contraseña Temporal</button>
            </form>
            <p id="reset-password-message" class="message" style="display: none;"></p>
        </div>
    </div>

    <!-- NUEVO: Modal para que el cliente cambie la contraseña temporal -->
    <div id="change-password-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Cambiar Contraseña</h3>
            <p class="instruction-message">
                Tu contraseña actual es temporal. Por favor, establece una nueva contraseña segura.
            </p>
            <form id="change-password-form">
                <div class="input-group input-float-group">
                    <input type="email" id="current-user-email-display" readonly placeholder=" ">
                    <label for="current-user-email-display">Tu Correo Electrónico</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="password" id="new-password-client" required placeholder=" ">
                    <label for="new-password-client">Nueva Contraseña</label>
                </div>
                <div class="input-group input-float-group">
                    <input type="password" id="confirm-new-password-client" required placeholder=" ">
                    <label for="confirm-new-password-client">Confirmar Nueva Contraseña</label>
                </div>
                <button type="submit" class="btn primary-btn">Cambiar Contraseña</button>
            </form>
            <p id="change-password-message" class="message" style="display: none;"></p>
        </div>
    </div>

    <!-- Modal de Confirmación de Eliminación para Admin -->
    <div id="delete-confirm-modal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h3>Confirmar Eliminación</h3>
            <p>¿Estás seguro de que quieres eliminar al cliente <strong id="client-to-delete-email"></strong>?</p>
            <p class="details-note"><i class="fas fa-exclamation-triangle"></i> Esta acción es irreversible.</p>
            <div class="modal-actions">
                <button type="button" class="btn secondary-btn" id="cancel-delete-btn">Cancelar</button>
                <button type="button" class="btn error-btn" id="confirm-delete-btn">Eliminar Cliente</button>
            </div>
            <p id="delete-message" class="message" style="display: none;"></p>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
